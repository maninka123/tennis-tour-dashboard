import{y as t,U as e,E as s,r as a,a as r,A as l,b as i}from"./bundle-es.js";import n from"./data-service5.js";import{I as c}from"./infinite-scroll.js";import{r as o}from"./templating.js";import{s as d}from"./setup-advert.js";import"./tournament-player-service.js";import"./api-client.js";import"./moment.js";import"./_commonjsHelpers.js";import"./content-api.js";import"./underscore.js";import"./tennis.js";import"./content.js";import"./tennis-tournament.js";import"./date.js";var _='<% players.forEach( function(player) { %> <% let adRowCounter=posCount - 1; %> <% if ( typeof adUnitPath !==\'undefined\' && adUnitPath && adRowCounter % 10===0 && adRowCounter>= 10 ) { %> <tr class="stats-list__ad-row"> <td class="stats-list__ad-cell" colspan="100"> <% let adIndex=adRowCounter / 10; %> <%= render( { data: { adIndex: adIndex, adID: \'stats-list-advert_\' + Date.now() + adIndex,\n                            cssClass: \'stats-list__advert\' } }, templates.advert ) %> </td> </tr> <% } %> <tr class="stats-list__row js-player-item-favourite" data-player-id="<%= player.PlayerNbr %>" data-player-name="<%= player.fullName %>"> <td class="stats-list__cell stats-list__cell--pos stats-list__cell--fixed-width h-xs-b dt:h-m-b <%= posCount >= 100 ? \'stats-list__cell--pos-small\' : \'\' %>"> <%= posCount++ %> </td> <td class="stats-list__cell stats-list__cell--player"> <div class="player-cell"> <div class="player-cell__photo-col"> <%= render( {\n                                    cssClass: \'player-cell__player-picture\',\n                                    id: player.PlayerNbr,\n                                    size: \'RANKINGS_TABLE\' ,\n                                    styleModifier: \'powered-up-square\'\n                                }, templates.playerHeadshot ) %> <button class="player-cell__star js-favourite-player-button" aria-label="<%= translator.lookupKey( \'label.favouriting.addtooltip\' ) %>" data-add-favourite-text="<%= translator.lookupKey( \'label.favouriting.addtooltip\' ) %>" data-remove-favourite-text="<%= translator.lookupKey( \'label.favouriting.removetooltip\' ) %>" data-player-name="<%= player.fullName %>" data-tracking="true" data-tracking-component="button click" data-tracking-category="control" data-tracking-type="make favourite" data-tracking-event="click_track" data-tracking-detail="" data-tracking-widget-type="<%= widgetType %>" data-tracking-widget-name="<%= widgetName %>"> </button> </div> <div class="player-cell__meta-col"> <div class="player-cell__name-wrap"> <span class="player-cell__name b-m-sb dt:b-xl-sb"> <span class="player-cell__name-inner u-show-tablet"> <%= player.firstInitial %></span> <span class="player-cell__name-inner u-hide-tablet"> <%= player.firstName %></span> <span class="player-cell__name-inner"> <%= player.lastName %></span> </span> </div> <div class="player-cell__country-wrap"> <%= render( { cssClass: \'player-cell__flag player-cell__flag--\' + player.Nationality, countryCode: player.Nationality }, templates.flagSvg ) %> <span class="player-cell__country l-m-m player-cell__country--<%=  player.Nationality  %>"> <%=  player.Nationality  %> </span> </div> </div> <a class="player-cell__link" href="<%= player.link %>" aria-label="<%= player.fullName %>" data-tracking="true" data-tracking-event="click_track" data-tracking-component="card click" data-tracking-category="stats card" data-tracking-type="player stats" data-tracking-detail="thumbnail" data-tracking-widget-type="Generic Widget" data-tracking-widget-name="Stats: Players List" data-stat-type="<%= currentStat %>"></a> </div> </td> <td class="stats-list__cell stats-list__cell--rank stats-list__cell--fixed-width <%= currentStat === \'Current_Rank\' ? \'stats-list__cell--current\' : \'\' %>"> <%= player.Current_Rank %> </td> <td class="stats-list__cell stats-list__cell--matches stats-list__cell--fixed-width <%= currentStat === \'MatchCount\' ? \'stats-list__cell--current\' : \'\' %>"> <%= player.MatchCount %> </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'Aces\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="Aces"> <%= player.Aces %> </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'Double_Faults\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="Double_Faults"> <%= player.Double_Faults %> </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'first_serve_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="first_serve_percent"> <%= player.first_serve_percent %> % </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'first_serve_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="first_serve_won_percent"> <%= player.first_serve_won_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'second_serve_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="second_serve_won_percent"> <%= player.second_serve_won_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'service_points_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="service_points_won_percent"> <%= player.service_points_won_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'breakpoint_saved_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="breakpoint_saved_percent"> <%= player.breakpoint_saved_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-serve <%= currentStat === \'service_games_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="service_games_won_percent"> <%= player.service_games_won_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-return <%= currentStat === \'first_return_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="first_return_percent"> <%= player.first_return_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-return <%= currentStat === \'second_return_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="second_return_percent"> <%= player.second_return_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-return <%= currentStat === \'return_games_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="return_games_won_percent"> <%= player.return_games_won_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-return <%= currentStat === \'breakpoint_converted_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="breakpoint_converted_percent"> <%= player.breakpoint_converted_percent %>% </td> <td class="stats-list__cell stats-list__cell--stat stats-list__column-return <%= currentStat === \'return_points_won_percent\' ? \'stats-list__cell--current\' : \'\' %>" data-stat="return_points_won_percent"> <%= player.return_points_won_percent %>% </td> </tr> <% } ) %>';const u="stats-list--loading",p={columnHead:"<%\n    var labelAbbr = translator.lookupKey( 'label.stats.' + stat + '.name.abbr' );\n    var labelFull = translator.lookupKey( 'label.stats.' + stat + '.name.full' );\n    var labelExplanation = translator.lookupKey( 'label.stats.' + stat + '.explanation' );\n    var defaultSort = defaultSort || 'desc';\n%> <th class=\"stats-list__header-cell stats-list__header-cell--sort <%= defaultSort === 'asc' ? 'stats-list__header-cell--default-asc' : '' %> <%= typeof type !== 'undefined' ? 'stats-list__column-' + type : '' %> js-sort-column <%= currentStat === stat ? currentCls : '' %> l-s-m dt:l-m-m\" data-stat=\"<%= stat %>\" data-tracking=\"true\" data-tracking-component=\"filter\" data-tracking-category=\"sort\" data-tracking-event=\"click_track\" data-tracking-widget-type=\"<%= typeof widgetType !== 'undefined' ? widgetType : '' %>\" data-tracking-widget-name=\"<%= typeof widgetName !== 'undefined' ? widgetName : '' %>\" data-tracking-filter-type=\"<%= stat %>\" data-tracking-filter-value=\"<%= sortDirection %>\"> <% if ( labelFull !== 'label.stats.' + stat + '.name.full' ) { %> <div class=\"stats-list__header-sort stats-list__header-sort--tooltip js-tooltip-label\"> <%= labelAbbr %> <%= render( {\n                cssClass: 'stats-list__sort-icon icon',\n                name: 'triangle'\n            }, templates.renderSvg ) %> <div class=\"stats-list__description\"> <div class=\"stats-list__description-title\"><%= labelFull %></div> <% if ( labelExplanation !== 'label.stats.' + stat + '.explanation' ) { %> <p class=\"stats-list__description-text\"><%= labelExplanation %></p> <% } %> </div> </div> <% } else { %> <div class=\"stats-list__header-sort\"> <%= labelAbbr %> <%= render( {\n                cssClass: 'stats-list__sort-icon icon',\n                name: 'triangle'\n            }, templates.renderSvg ) %> </div> <% } %> </th>",playerRow:_};class h{constructor(t){this.container=t,this.statsContent=t.querySelector(".js-content"),this.loader=t.querySelector(".js-loader-new"),this.loaderMore=t.querySelector(".js-loader"),this.showMoreButton=t.querySelector(".js-show-more-button"),this.errorContainer=t.querySelector(".js-stats-error"),this.serveStatsToggle=t.querySelector(".js-serve-stats"),this.returnStatsToggle=t.querySelector(".js-return-stats"),this.mobileNav=document.querySelector(".js-mobile-main-nav-bar"),this.customFilters=[].slice.call(t.querySelectorAll(".js-custom-filter")),this.statsYear=t.dataset.year,this.statsType="serve",this.statsMetric="Current_Rank",this.sortDirection="asc",this.posCount=1,this.dataService=new n(t,S.call(this)),this.widgetName=this.container.dataset.widgetName,this.widgetType=this.container.dataset.widgetType,this.adUnitPath=this.container.dataset.adUnitPath,this.init()}init(){document.body.classList.add("u-no-overflow"),t(this.showMoreButton,()=>{this.infiniteScroll?this.infiniteScroll.start():this.infiniteScroll=new c(this.container,this.render,!0,f.bind(this))}),t(this.serveStatsToggle,v.bind(this,"serve")),t(this.returnStatsToggle,v.bind(this,"return")),this.customFilters.forEach(e=>t(e,t=>g.call(this,t)))}render(t,l=!1,i=!1){if(this.container.classList.remove(u),this.dataService.loading=!1,!t)return void(0===this.currentPage?b.call(this):(this.infiniteScroll&&this.infiniteScroll.stop(),this.loaderMore.classList.add(e)));if(0===t.length)return this.infiniteScroll&&this.infiniteScroll.stop(),void this.loaderMore.classList.add(e);const n=w(t);if(l){const t=`stats-list__header-cell--current stats-list__header-cell--${this.sortDirection}`,e={players:n,posCount:this.posCount,currentStat:this.statsMetric,currentCls:t,adUnitPath:this.adUnitPath,childTemplates:p,widgetName:this.widgetName,widgetType:this.widgetType,sortDirection:this.sortDirection};this.statsContent.innerHTML=o(e,"<table class=\"stats-list__table\"> <thead class=\"stats-list__table-head js-table-head\"> <th class=\"stats-list__header-cell stats-list__header-cell--pos l-s-m dt:l-m-m\"><span><%= translator.lookupKey( 'label.stats.pos' ) %></span></th> <th class=\"stats-list__header-cell stats-list__header-cell--player l-s-m dt:l-m-m\"><span><%= translator.lookupKey( 'label.rankings.player' ) %></span></th> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'Current_Rank', defaultSort: 'asc', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'MatchCount', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'Aces', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'Double_Faults', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'first_serve_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'first_serve_won_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'second_serve_won_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'service_points_won_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'breakpoint_saved_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'service_games_won_percent', type: 'serve', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'first_return_percent', type: 'return', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'second_return_percent', type: 'return', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'return_games_won_percent', type: 'return', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'breakpoint_converted_percent', type: 'return', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> <%= render( { currentStat: currentStat, currentCls: currentCls, stat: 'return_points_won_percent', type: 'return', widgetName, widgetType, sortDirection }, childTemplates.columnHead ) %> </thead> <tbody class=\"stats-list__table-body js-table-body\"> <%= render( { players: players, posCount: posCount, currentStat: currentStat, adUnitPath: adUnitPath, widgetName: widgetName, widgetType: widgetType }, childTemplates.playerRow ) %> </tbody> </table>"),m.call(this)}else{this.statsContent.querySelector(".js-table-body").insertAdjacentHTML("beforeend",o({players:n,posCount:this.posCount,currentStat:this.statsMetric,adUnitPath:this.adUnitPath,widgetName:this.widgetName,widgetType:this.widgetType},_)),document.dispatchEvent(new CustomEvent(s.PLAYERS.RENDERED,{}))}a(s.PLAYERS.RENDERED,{}),this.posCount+=t.length,this.tableHead=this.statsContent.querySelector(".js-table-head"),r("player-headshot/player-headshot",this.statsContent),i&&(this.showMoreButton.classList.remove(e),this.container.classList.remove("cls-padding")),this.loader.classList.add(e),this.errorContainer.classList.add(e),this.adUnitPath.length>0&&this.setupAds()}setupAds(){const t=this.container.querySelectorAll(".js-advert");[].forEach.call(t,t=>{if("true"!==t.getAttribute("data-activated")){const e=t.dataset.index,s={adID:t.dataset.id,adUnitPath:`${this.adUnitPath}_${e}`,size:"responsive"};d(s),t.setAttribute("data-activated",!0)}})}}const m=function(){[].slice.call(this.statsContent.querySelectorAll(".js-sort-column")).forEach(e=>{t(e,t=>y.call(this,t.currentTarget.dataset.stat))});[].slice.call(this.statsContent.querySelectorAll(".js-tooltip-label")).forEach(t=>{t.addEventListener("mouseenter",t=>{this.tooltipTimer=setTimeout(()=>{t.target.classList.add("stats-list__header-sort--tooltip-open")},300)}),t.addEventListener("mouseleave",t=>{t.target.classList.remove("stats-list__header-sort--tooltip-open"),clearTimeout(this.tooltipTimer)})})},y=function(t){t!==this.statsMetric?this.sortDirection="Current_Rank"===t?"asc":"desc":this.sortDirection="desc"===this.sortDirection?"asc":"desc",this.statsMetric=t,this.posCount=1,this.infiniteScroll&&this.infiniteScroll.stop(),this.errorContainer.classList.add(e),this.showMoreButton.classList.add(e),this.loaderMore.classList.add(e),this.container.classList.add(u),this.loader.classList.remove(e),this.dataService.load({type:this.statsMetric,sort:this.sortDirection,page:0})},g=function(t){t.currentTarget.classList.toggle("stats-list__custom-filter--checked"),this.statsContent.classList.toggle(`stats-list__table-container--${t.currentTarget.dataset.stat}`)},v=function(t){t!==this.statsType&&(this.statsType=t,"serve"===t?(this.returnStatsToggle.classList.remove(l),this.container.classList.remove("stats-list--returns"),this.serveStatsToggle.classList.add(l)):(this.serveStatsToggle.classList.remove(l),this.returnStatsToggle.classList.add(l),this.container.classList.add("stats-list--returns")))},w=function(t){return t.map(t=>(t.id=t.PlayerNbr,t.fullName=`${t.First_Name} ${t.Last_Name}`,t.firstName=t.First_Name.toLowerCase(),t.lastName=t.Last_Name.toLowerCase(),t.firstInitial=t.firstName.charAt(0),t.type="tennis_player",t.link=i(t),t))},S=function(){return{render:this.render.bind(this),page:0,type:this.statsMetric,sort:this.sortDirection,year:this.statsYear}},f=function(){this.dataService.loadMore()},b=function(){this.dataService.loading=!1,this.loader.classList.add(e),this.loaderMore.classList.add(e),this.errorContainer.classList.remove(e)};export{h as default};
